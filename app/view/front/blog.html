{% extends "./base.html" %}

<!-- Body -->
{% block body %}
<div class="kis__blog">
  <h2>{{ blog.title }}</h2>
  <p>{{ blog.createdAt }} â€¢ {{ blog.readTime }} â€¢ ğŸ‘€ {{ blog.readCount }}</p>
  <div>{{ blog.content | safe }}</div>

  <div class="kis__divider"></div>
  <div class="kis__blog__like">
    <span>è¿™ç¯‡æ–‡ç« å¯¹ä½ æœ‰å¸®åŠ©å—?</span>
    <a href="javascript:;" id="js_likeBtn">ğŸ‘ğŸ»({{ blog.likeCount }})</a>
    <a href="javascript:;" id="js_dislikeBtn">ğŸ‘ğŸ»({{ blog.dislikeCount }})</a>
  </div>
</div>
{% endblock %}

<!-- Foot -->
{% block foot %}
<script>
  $(document).ready(function () {
    var $likeBtn = $("#js_likeBtn");
    var $dislikeBtn = $("#js_dislikeBtn");
    $likeBtn.on("click", function () {
      if ($likeBtn.hasClass("active")) {
        return;
      }
      $.ajax({
        method: "PUT",
        url: "/api/v1/blog/{{ blog.id }}/like",
        data: {
          decrease: $dislikeBtn.hasClass("active"),
        },
        success: function (res) {
          if (res.success) {
            $likeBtn.html("ğŸ‘(" + res.data.likeCount + ")").addClass("active");
            $dislikeBtn.html("ğŸ‘ğŸ»(" + res.data.dislikeCount + ")").removeClass("active");
          }
        },
      });
    });

    $dislikeBtn.on("click", function () {
      if ($dislikeBtn.hasClass("active")) {
        return;
      }
      $.ajax({
        method: "PUT",
        url: "/api/v1/blog/{{ blog.id }}/dislike",
        data: {
          decrease: $likeBtn.hasClass("active"),
        },
        success: function (res) {
          if (res.success) {
            $likeBtn.html("ğŸ‘ğŸ»(" + res.data.likeCount + ")").removeClass("active");
            $dislikeBtn.html("ğŸ‘(" + res.data.dislikeCount + ")").addClass("active");
          }
        },
      });
    });
  });
</script>
{% endblock %}
